DROP TABLE TABLE_A;
DROP TABLE TABLE_ESVF;
DROP TABLE TABLE_ESV;
DROP TABLE TABLE_ESIF;
DROP TABLE TABLE_ESI;
DROP TABLE TABLE_ESA;
DROP TABLE TABLE_ES;
DROP TABLE TABLE_E;
DROP TABLE TABLE_GA;
DROP TABLE TABLE_GB;
DROP TABLE TABLE_G;
DROP TABLE TABLE_GC;
DROP TABLE TABLE_U;

CREATE TABLE TABLE_U
(
    USER_ID VARCHAR2(4000) PRIMARY KEY,
    PASSWORD VARCHAR2(4000) NOT NULL,
    NAME VARCHAR2(4000) NOT NULL,
    IMAGE_ID VARCHAR2(4000),
    REGION VARCHAR2(4000) NOT NULL
);
CREATE TABLE TABLE_GC
(
    GROUP_CATEGORY_ID NUMBER PRIMARY KEY,
    NAME VARCHAR2(4000) NOT NULL UNIQUE
);
DROP SEQUENCE GC_SEQ;
CREATE SEQUENCE GC_SEQ;
CREATE TABLE TABLE_G
(
    GROUP_ID NUMBER PRIMARY KEY,
    GROUP_CATEGORY_ID NUMBER NOT NULL,
    REGION VARCHAR2(4000) NOT NULL,
    USER_ID VARCHAR2(4000) NOT NULL,
    NAME VARCHAR2(4000) NOT NULL,
    CONTENT VARCHAR2(4000) NOT NULL,
    GROUP_LOGO VARCHAR2(4000) UNIQUE,
    GROUP_IMAGE VARCHAR2(4000) UNIQUE,
    CONSTRAINT G_UI_FK FOREIGN KEY(USER_ID) REFERENCES TABLE_U(USER_ID),
    CONSTRAINT G_GCI_FK FOREIGN KEY(GROUP_CATEGORY_ID) REFERENCES TABLE_GC(GROUP_CATEGORY_ID)
);
DROP SEQUENCE G_SEQ;
CREATE SEQUENCE G_SEQ;
CREATE TABLE TABLE_GB
(
	GROUP_BOARD_ID NUMBER PRIMARY KEY,
	GROUP_ID NUMBER NOT NULL,
	USER_ID VARCHAR2(4000) NOT NULL,
	TITLE VARCHAR2(4000) NOT NULL,
	CONTENT VARCHAR2(4000) NOT NULL,
	CONSTRAINT GB_GI FOREIGN KEY(GROUP_ID) REFERENCES TABLE_G(GROUP_ID),
	CONSTRAINT GB_UI FOREIGN KEY(USER_ID) REFERENCES TABLE_U(USER_ID)
);
CREATE TABLE TABLE_GA
(
    USER_ID VARCHAR2(4000) NOT NULL,
    GROUP_ID NUMBER NOT NULL,
    BLIND NUMBER DEFAULT 1,
    CONSTRAINT GA_UI_FK FOREIGN KEY(USER_ID) REFERENCES TABLE_U(USER_ID),
    CONSTRAINT GA_GI_FK FOREIGN KEY(GROUP_ID) REFERENCES TABLE_G(GROUP_ID),
    CONSTRAINT GA_PK PRIMARY KEY(USER_ID, GROUP_ID)
);
CREATE TABLE TABLE_E
(
	EVENT_ID NUMBER PRIMARY KEY,
	NAME VARCHAR2(4000) NOT NULL,
	CONTENT VARCHAR2(4000) NOT NULL,
	GROUP_ID NUMBER NOT NULL,
	USER_ID VARCHAR2(4000) NOT NULL,
	CONSTRAINT E_GI_FK FOREIGN KEY(GROUP_ID) REFERENCES TABLE_G(GROUP_ID),
	CONSTRAINT E_UI_FK FOREIGN KEY(USER_ID) REFERENCES TABLE_U(USER_ID)
);
DROP SEQUENCE E_SEQ;
CREATE SEQUENCE E_SEQ;
CREATE TABLE TABLE_ES
(
	EVENT_SCHEDULE_ID NUMBER PRIMARY KEY,
	TITLE VARCHAR2(4000) NOT NULL,
	PLACE VARCHAR2(4000),
	START_DATE NUMBER NOT NULL,
	END_DATE NUMBER NOT NULL,
	EVENT_ID NUMBER NOT NULL,
	CONSTRAINT ES_EI_FK FOREIGN KEY(EVENT_ID) REFERENCES TABLE_E(EVENT_ID)
);
DROP SEQUENCE ES_SEQ;
CREATE SEQUENCE ES_SEQ;
CREATE TABLE TABLE_ESA
(
    EVENT_SCHEDULE_ID NUMBER NOT NULL,
    USER_ID VARCHAR2(4000),
    CONSTRAINT ESA_ESI_FK FOREIGN KEY(EVENT_SCHEDULE_ID) REFERENCES TABLE_ES(EVENT_SCHEDULE_ID),
    CONSTRAINT ESA_UI_FK FOREIGN KEY(USER_ID) REFERENCES TABLE_U(USER_ID)
);
CREATE TABLE TABLE_ESV
(
	EVENT_SCHEDULE_VIDEO_ID VARCHAR2(100) PRIMARY KEY,
	FILENAME VARCHAR2(4000) NOT NULL,
	EXT VARCHAR2(4000) NOT NULL,
	DETECT_DATE NUMBER,
	USER_ID VARCHAR2(4000) NOT NULL,
	EVENT_SCHEDULE_ID NUMBER,
	CONSTRAINT ESV_UI_FK FOREIGN KEY(USER_ID) REFERENCES TABLE_U(USER_ID),
	CONSTRAINT ESV_ESI_FK FOREIGN KEY(EVENT_SCHEDULE_ID) REFERENCES TABLE_ES(EVENT_SCHEDULE_ID)
);
CREATE TABLE TABLE_ESVF
(
	EVENT_SCHEDULE_VIDEO_FACE_ID VARCHAR2(4000) PRIMARY KEY,
	EVENT_SCHEDULE_VIDEO_IMAGE_ID VARCHAR2(4000) NOT NULL,
	EVENT_SCHEDULE_VIDEO_ID NOT NULL,
	DETECT_DATE NUMBER,
	CONSTRAINT ESVF_ECVI_FK FOREIGN KEY(EVENT_SCHEDULE_VIDEO_ID) REFERENCES TABLE_ESV(EVENT_SCHEDULE_VIDEO_ID)
);
CREATE TABLE TABLE_ESI
(
	EVENT_SCHEDULE_IMAGE_ID VARCHAR2(4000) PRIMARY KEY,
	FILENAME VARCHAR2(4000) NOT NULL,
	EXT VARCHAR2(4000) NOT NULL,
	DETECT_DATE NUMBER,
	USER_ID VARCHAR2(4000) NOT NULL,
	EVENT_SCHEDULE_ID NUMBER,
	CONSTRAINT ESI_UI_FK FOREIGN KEY(USER_ID) REFERENCES TABLE_U(USER_ID),
	CONSTRAINT ESI_ESI_FK FOREIGN KEY(EVENT_SCHEDULE_ID) REFERENCES TABLE_ES(EVENT_SCHEDULE_ID)
);
CREATE TABLE TABLE_ESIF
(
	EVENT_SCHEDULE_IMAGE_FACE_ID VARCHAR2(4000) PRIMARY KEY,
	TOP NUMBER NOT NULL,
	LEFT NUMBER NOT NULL,
	WIDTH NUMBER NOT NULL,
	HEIGHT NUMBER NOT NULL,
	EVENT_SCHEDULE_IMAGE_ID VARCHAR2(4000) NOT NULL,
	CONSTRAINT ESIF_ECII_FK FOREIGN KEY(EVENT_SCHEDULE_IMAGE_ID) REFERENCES TABLE_ESI(EVENT_SCHEDULE_IMAGE_ID)
);
CREATE TABLE TABLE_A
(
	EVENT_SCHEDULE_IMAGE_ID VARCHAR2(4000) NOT NULL,
	USER_ID VARCHAR2(4000) NOT NULL,
	BLIND NUMBER DEFAULT 1,
	SELF NUMBER DEFAULT 0,
	CONSTRAINT A_ESII_FK FOREIGN KEY(EVENT_SCHEDULE_IMAGE_ID) REFERENCES TABLE_ESI(EVENT_SCHEDULE_IMAGE_ID),
	CONSTRAINT A_UI_FK FOREIGN KEY(USER_ID) REFERENCES TABLE_U(USER_ID),
    CONSTRAINT A_PK PRIMARY KEY(EVENT_SCHEDULE_IMAGE_ID, USER_ID)
);

INSERT INTO TABLE_U(USER_ID, PASSWORD, NAME, IMAGE_ID, REGION) VALUES('id1', 'password', 'name1', 'image.jpg', '광주');
INSERT INTO TABLE_U(USER_ID, PASSWORD, NAME, REGION) VALUES('id2', 'password', 'name2', '광주');
INSERT INTO TABLE_GC(GROUP_CATEGORY_ID, NAME) VALUES(1, '게임');
INSERT INTO TABLE_G(GROUP_ID, GROUP_CATEGORY_ID, REGION, USER_ID, NAME, CONTENT) VALUES(1, 1, '광주', 'id1', 'group1', 'group1content');
INSERT INTO TABLE_G(GROUP_ID, GROUP_CATEGORY_ID, REGION, USER_ID, NAME, CONTENT) VALUES(2, 1, '광주', 'id2', 'group2', 'group2content');
INSERT INTO TABLE_G(GROUP_ID, GROUP_CATEGORY_ID, REGION, USER_ID, NAME, CONTENT) VALUES(3, 1, '광주', 'id1', 'group3', 'group3content');
INSERT INTO TABLE_GB(GROUP_BOARD_ID, GROUP_ID, USER_ID, TITLE, CONTENT) VALUES(1, 1, 'id1', 'group1boardtitle1', 'group1boardcontent1');
INSERT INTO TABLE_GA(USER_ID, GROUP_ID) VALUES('id1', 1);
INSERT INTO TABLE_GA(USER_ID, GROUP_ID) VALUES('id2', 2);
INSERT INTO TABLE_GA(USER_ID, GROUP_ID) VALUES('id1', 3);
INSERT INTO TABLE_E(EVENT_ID, NAME, CONTENT, GROUP_ID, USER_ID) VALUES(1, 'event1', 'event1content', 1, 'id1');
INSERT INTO TABLE_E(EVENT_ID, NAME, CONTENT, GROUP_ID, USER_ID) VALUES(2, 'event2', 'event2content', 2, 'id2');
INSERT INTO TABLE_ES(EVENT_SCHEDULE_ID, TITLE, PLACE, START_DATE, END_DATE, EVENT_ID) VALUES(1, 'event_schedule1', '광주', 0, 0, 1);
INSERT INTO TABLE_ES(EVENT_SCHEDULE_ID, TITLE, PLACE, START_DATE, END_DATE, EVENT_ID) VALUES(2, 'event_schedule2', '광주', 0, 0, 2);
INSERT INTO TABLE_ESA(EVENT_SCHEDULE_ID, USER_ID) VALUES(1, 'id1');
INSERT INTO TABLE_ESV(EVENT_SCHEDULE_VIDEO_ID, FILENAME, EXT, USER_ID, EVENT_SCHEDULE_ID) VALUES('e37ca75893', 'e37ca75893.mp4', 'mp4', 'id1', 1);
INSERT INTO TABLE_ESI(EVENT_SCHEDULE_IMAGE_ID, FILENAME, EXT, USER_ID, EVENT_SCHEDULE_ID) VALUES('event_schedule1_image1.jpg', 'event_schedule1_image1.jpg', 'jpg', 'id1', 1);
INSERT INTO TABLE_ESI(EVENT_SCHEDULE_IMAGE_ID, FILENAME, EXT, USER_ID, EVENT_SCHEDULE_ID) VALUES('event_schedule1_image2.jpg', 'event_schedule1_image2.jpg', 'jpg', 'id1', 1);
INSERT INTO TABLE_ESI(EVENT_SCHEDULE_IMAGE_ID, FILENAME, EXT, USER_ID, EVENT_SCHEDULE_ID) VALUES('event_schedule1_image3.jpg', 'event_schedule1_image3.jpg', 'jpg', 'id1', 1);
INSERT INTO TABLE_ESI(EVENT_SCHEDULE_IMAGE_ID, FILENAME, EXT, USER_ID, EVENT_SCHEDULE_ID) VALUES('event_schedule1_image4.jpg', 'event_schedule1_image4.jpg', 'jpg', 'id1', 1);
INSERT INTO TABLE_ESI(EVENT_SCHEDULE_IMAGE_ID, FILENAME, EXT, USER_ID, EVENT_SCHEDULE_ID) VALUES('event_schedule1_image5.jpg', 'event_schedule1_image5.jpg', 'jpg', 'id1', 1);
INSERT INTO TABLE_ESI(EVENT_SCHEDULE_IMAGE_ID, FILENAME, EXT, USER_ID, EVENT_SCHEDULE_ID) VALUES('event_schedule1_image6.jpg', 'event_schedule1_image6.jpg', 'jpg', 'id1', 1);
INSERT INTO TABLE_ESI(EVENT_SCHEDULE_IMAGE_ID, FILENAME, EXT, USER_ID, EVENT_SCHEDULE_ID) VALUES('event_schedule1_image7.jpg', 'event_schedule1_image7.jpg', 'jpg', 'id1', 1);
COMMIT;